<!doctype html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>AI Chat</title>
  <link rel="stylesheet" href="./styles.css">
</head>
<body>
  <div class="app">
    <aside class="sidebar">
      <div class="brand">
        <div class="logo">AI</div>
        <div>
          <div class="title">AI Chat</div>
          <div class="sub">Firebase + GitHub Pages</div>
        </div>
      </div>

      <div class="authbox" id="authBox">
        <div class="tabs">
          <button class="tab active" id="tabLogin">Giriş</button>
          <button class="tab" id="tabRegister">Kayıt</button>
        </div>

        <form class="form" id="loginForm">
          <label>E-posta</label>
          <input id="loginEmail" type="email" placeholder="ornek@mail.com" required>
          <label>Şifre</label>
          <input id="loginPass" type="password" placeholder="••••••••" required>
          <button class="btn primary" type="submit">Giriş Yap</button>
          <button class="btn ghost" type="button" id="forgotBtn">Şifremi unuttum</button>
          <div class="hint" id="loginHint"></div>
        </form>

        <form class="form hidden" id="registerForm">
          <label>E-posta</label>
          <input id="regEmail" type="email" placeholder="ornek@mail.com" required>
          <label>Şifre</label>
          <input id="regPass" type="password" placeholder="En az 6 karakter" minlength="6" required>
          <label>Şifre (tekrar)</label>
          <input id="regPass2" type="password" placeholder="••••••••" minlength="6" required>
          <button class="btn primary" type="submit">Kayıt Ol</button>
          <div class="hint" id="regHint"></div>
        </form>
      </div>

      <div class="verify hidden" id="verifyBox">
        <div class="verifyTitle">E-postanı doğrula</div>
        <div class="verifyText">
          Doğrulama linki mailine gitti. Linke tıkladıktan sonra aşağıdan kontrol et.
        </div>
        <div class="row">
          <button class="btn" id="resendBtn">Tekrar gönder</button>
          <button class="btn primary" id="checkedBtn">Doğruladım</button>
        </div>
        <div class="hint" id="verifyHint"></div>
      </div>

      <div class="panel hidden" id="appPanel">
        <div class="userRow">
          <div class="userChip" id="userChip">—</div>
          <div class="userActions">
            <button class="iconBtn" id="settingsBtn" title="Ayarlar">⚙</button>
            <button class="iconBtn" id="logoutBtn" title="Çıkış">⎋</button>
          </div>
        </div>

        <button class="btn primary full" id="newChatBtn">+ Yeni sohbet</button>

        <div class="sectionTitle">Sohbetler</div>
        <div class="chatList" id="chatList"></div>
      </div>

      <div class="footerNote">
        Not: OpenAI API tarayıcıdan direkt çağrıda CORS çıkabilir; bu kurulum Worker proxy ile çözülür. :contentReference[oaicite:2]{index=2}
      </div>
    </aside>

    <main class="main">
      <header class="topbar">
        <div class="topLeft">
          <div class="bigTitle" id="chatTitle">Giriş yap</div>
          <div class="smallSub" id="chatSub">Sohbetlerini kaydet, eski sohbetlere dön.</div>
        </div>
        <div class="topRight">
          <span class="pill" id="modelPill">Model: —</span>
        </div>
      </header>

      <section class="messages" id="messages">
        <div class="emptyState" id="emptyState">
          <div class="emptyCard">
            <div class="emptyTitle">AI Chat hazır</div>
            <div class="emptyText">Giriş yap → yeni sohbet oluştur → yazmaya başla.</div>
          </div>
        </div>
      </section>

      <footer class="composerWrap">
        <div class="composer">
          <textarea id="prompt" placeholder="Mesaj yaz… (Enter gönder, Shift+Enter alt satır)" rows="1"></textarea>
          <button class="sendBtn" id="sendBtn">Gönder</button>
        </div>
        <div class="tinyHint" id="tinyHint"></div>
      </footer>
    </main>
  </div>

  <!-- Settings Modal -->
  <div class="modal hidden" id="modal">
    <div class="modalCard">
      <div class="modalHead">
        <div>
          <div class="modalTitle">Ayarlar</div>
          <div class="modalSub">Tek API key sende kalsın diye Worker (proxy) kullanıyoruz.</div>
        </div>
        <button class="iconBtn" id="closeModal">✕</button>
      </div>

      <div class="form">
        <label>Gateway (Worker) URL</label>
        <input id="gatewayUrl" type="text" placeholder="https://xxxx.workers.dev">

        <label>Gateway Token (opsiyonel ama önerilir)</label>
        <input id="gatewayToken" type="password" placeholder="Worker APP_TOKEN">

        <label>Model</label>
        <input id="model" type="text" placeholder="gpt-4o-mini">

        <label>Temperature</label>
        <input id="temp" type="number" min="0" max="2" step="0.1" value="0.7">

        <label>System Prompt</label>
        <textarea id="systemPrompt" rows="3" placeholder="Örn: Türkçe kısa cevap ver."></textarea>

        <div class="row">
          <button class="btn" id="resetSettings">Sıfırla</button>
          <button class="btn primary" id="saveSettings">Kaydet</button>
        </div>

        <div class="hint" id="settingsHint"></div>
      </div>
    </div>
  </div>

  <script type="module" src="./app.js"></script>
</body>
</html>
